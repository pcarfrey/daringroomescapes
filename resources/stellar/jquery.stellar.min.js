!function(t,e,i,s){function d(e,i){this.element=e,this.options=t.extend({},o,i),this._defaults=o,this._name=n,this.init()}var n="stellar",o={scrollProperty:"scroll",positionProperty:"position",horizontalScrolling:!0,verticalScrolling:!0,horizontalOffset:0,verticalOffset:0,responsive:!1,parallaxBackgrounds:!0,parallaxElements:!0,hideDistantElements:!0,hideElement:function(t){t.hide()},showElement:function(t){t.show()}},r={scroll:{getLeft:function(t){return t.scrollLeft()},setLeft:function(t,e){t.scrollLeft(e)},getTop:function(t){return t.scrollTop()},setTop:function(t,e){t.scrollTop(e)}},position:{getLeft:function(t){return-1*parseInt(t.css("left"),10)},getTop:function(t){return-1*parseInt(t.css("top"),10)}},margin:{getLeft:function(t){return-1*parseInt(t.css("margin-left"),10)},getTop:function(t){return-1*parseInt(t.css("margin-top"),10)}},transform:{getLeft:function(t){var e=getComputedStyle(t[0])[f];return"none"!==e?-1*parseInt(e.match(/(-?[0-9]+)/g)[4],10):0},getTop:function(t){var e=getComputedStyle(t[0])[f];return"none"!==e?-1*parseInt(e.match(/(-?[0-9]+)/g)[5],10):0}}},a={position:{setLeft:function(t,e){t.css("left",e)},setTop:function(t,e){t.css("top",e)}},transform:{setPosition:function(t,e,i,s,n){t[0].style[f]="translate3d("+(e-i)+"px, "+(s-n)+"px, 0)"}}},l=function(){var n,e=/^(Moz|Webkit|Khtml|O|ms|Icab)(?=[A-Z])/,i=t("script")[0].style,s="";for(n in i)if(e.test(n)){s=n.match(e)[0];break}return"WebkitOpacity"in i&&(s="Webkit"),"KhtmlOpacity"in i&&(s="Khtml"),function(t){return s+(s.length>0?t.charAt(0).toUpperCase()+t.slice(1):t)}}(),f=l("transform"),c=t("<div />",{style:"background:#fff"}).css("background-position-x")!==s,u=c?function(t,e,i){t.css({"background-position-x":e,"background-position-y":i})}:function(t,e,i){t.css("background-position",e+" "+i)},h=c?function(t){return[t.css("background-position-x"),t.css("background-position-y")]}:function(t){return t.css("background-position").split(" ")},p=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(t){setTimeout(t,1e3/60)};d.prototype={init:function(){this.options.name=n+"_"+Math.floor(1e9*Math.random()),this._defineElements(),this._defineGetters(),this._defineSetters(),this._handleWindowLoadAndResize(),this._detectViewport(),this.refresh({firstLoad:!0}),"scroll"===this.options.scrollProperty?this._handleScrollEvent():this._startAnimationLoop()},_defineElements:function(){this.element===i.body&&(this.element=e),this.$scrollElement=t(this.element),this.$element=this.element===e?t("body"):this.$scrollElement,this.$viewportElement=this.options.viewportElement!==s?t(this.options.viewportElement):this.$scrollElement[0]===e||"scroll"===this.options.scrollProperty?this.$scrollElement:this.$scrollElement.parent()},_defineGetters:function(){var t=this,e=r[t.options.scrollProperty];this._getScrollLeft=function(){return e.getLeft(t.$scrollElement)},this._getScrollTop=function(){return e.getTop(t.$scrollElement)}},_defineSetters:function(){var e=this,i=r[e.options.scrollProperty],s=a[e.options.positionProperty],n=i.setLeft,o=i.setTop;this._setScrollLeft="function"==typeof n?function(t){n(e.$scrollElement,t)}:t.noop,this._setScrollTop="function"==typeof o?function(t){o(e.$scrollElement,t)}:t.noop,this._setPosition=s.setPosition||function(t,i,n,o,r){e.options.horizontalScrolling&&s.setLeft(t,i,n),e.options.verticalScrolling&&s.setTop(t,o,r)}},_handleWindowLoadAndResize:function(){var i=this,s=t(e);i.options.responsive&&s.bind("load."+this.name,function(){i.refresh()}),s.bind("resize."+this.name,function(){i._detectViewport(),i.options.responsive&&i.refresh()})},refresh:function(i){var s=this,n=s._getScrollLeft(),o=s._getScrollTop();i&&i.firstLoad||this._reset(),this._setScrollLeft(0),this._setScrollTop(0),this._setOffsets(),this._findParticles(),this._findBackgrounds(),i&&i.firstLoad&&/WebKit/.test(navigator.userAgent)&&t(e).load(function(){var t=s._getScrollLeft(),e=s._getScrollTop();s._setScrollLeft(t+1),s._setScrollTop(e+1),s._setScrollLeft(t),s._setScrollTop(e)}),this._setScrollLeft(n),this._setScrollTop(o)},_detectViewport:function(){var t=this.$viewportElement.offset(),e=null!==t&&t!==s;this.viewportWidth=this.$viewportElement.width(),this.viewportHeight=this.$viewportElement.height(),this.viewportOffsetTop=e?t.top:0,this.viewportOffsetLeft=e?t.left:0},_findParticles:function(){{var e=this;this._getScrollLeft(),this._getScrollTop()}if(this.particles!==s)for(var o=this.particles.length-1;o>=0;o--)this.particles[o].$element.data("stellar-elementIsActive",s);this.particles=[],this.options.parallaxElements&&this.$element.find("[data-stellar-ratio]").each(function(){var o,r,a,l,f,c,u,h,p,n=t(this),d=0,g=0,m=0,v=0;if(n.data("stellar-elementIsActive")){if(n.data("stellar-elementIsActive")!==this)return}else n.data("stellar-elementIsActive",this);e.options.showElement(n),n.data("stellar-startingLeft")?(n.css("left",n.data("stellar-startingLeft")),n.css("top",n.data("stellar-startingTop"))):(n.data("stellar-startingLeft",n.css("left")),n.data("stellar-startingTop",n.css("top"))),a=n.position().left,l=n.position().top,f="auto"===n.css("margin-left")?0:parseInt(n.css("margin-left"),10),c="auto"===n.css("margin-top")?0:parseInt(n.css("margin-top"),10),h=n.offset().left-f,p=n.offset().top-c,n.parents().each(function(){var e=t(this);return e.data("stellar-offset-parent")===!0?(d=m,g=v,u=e,!1):(m+=e.position().left,void(v+=e.position().top))}),o=n.data("stellar-horizontal-offset")!==s?n.data("stellar-horizontal-offset"):u!==s&&u.data("stellar-horizontal-offset")!==s?u.data("stellar-horizontal-offset"):e.horizontalOffset,r=n.data("stellar-vertical-offset")!==s?n.data("stellar-vertical-offset"):u!==s&&u.data("stellar-vertical-offset")!==s?u.data("stellar-vertical-offset"):e.verticalOffset,e.particles.push({$element:n,$offsetParent:u,isFixed:"fixed"===n.css("position"),horizontalOffset:o,verticalOffset:r,startingPositionLeft:a,startingPositionTop:l,startingOffsetLeft:h,startingOffsetTop:p,parentOffsetLeft:d,parentOffsetTop:g,stellarRatio:n.data("stellar-ratio")!==s?n.data("stellar-ratio"):1,width:n.outerWidth(!0),height:n.outerHeight(!0),isHidden:!1})})},_findBackgrounds:function(){var o,e=this,i=this._getScrollLeft(),n=this._getScrollTop();this.backgrounds=[],this.options.parallaxBackgrounds&&(o=this.$element.find("[data-stellar-background-ratio]"),this.$element.data("stellar-background-ratio")&&(o=o.add(this.$element)),o.each(function(){var a,l,p,d,g,m,v,o=t(this),r=h(o),O=0,L=0,_=0,T=0;if(o.data("stellar-backgroundIsActive")){if(o.data("stellar-backgroundIsActive")!==this)return}else o.data("stellar-backgroundIsActive",this);o.data("stellar-backgroundStartingLeft")?u(o,o.data("stellar-backgroundStartingLeft"),o.data("stellar-backgroundStartingTop")):(o.data("stellar-backgroundStartingLeft",r[0]),o.data("stellar-backgroundStartingTop",r[1])),p="auto"===o.css("margin-left")?0:parseInt(o.css("margin-left"),10),d="auto"===o.css("margin-top")?0:parseInt(o.css("margin-top"),10),g=o.offset().left-p-i,m=o.offset().top-d-n,o.parents().each(function(){var e=t(this);return e.data("stellar-offset-parent")===!0?(O=_,L=T,v=e,!1):(_+=e.position().left,void(T+=e.position().top))}),a=o.data("stellar-horizontal-offset")!==s?o.data("stellar-horizontal-offset"):v!==s&&v.data("stellar-horizontal-offset")!==s?v.data("stellar-horizontal-offset"):e.horizontalOffset,l=o.data("stellar-vertical-offset")!==s?o.data("stellar-vertical-offset"):v!==s&&v.data("stellar-vertical-offset")!==s?v.data("stellar-vertical-offset"):e.verticalOffset,e.backgrounds.push({$element:o,$offsetParent:v,isFixed:"fixed"===o.css("background-attachment"),horizontalOffset:a,verticalOffset:l,startingValueLeft:r[0],startingValueTop:r[1],startingBackgroundPositionLeft:isNaN(parseInt(r[0],10))||-1!==r[0].indexOf("%")?0:parseInt(r[0],10),startingBackgroundPositionTop:isNaN(parseInt(r[1],10))||-1!==r[1].indexOf("%")?0:parseInt(r[1],10),startingPositionLeft:o.position().left,startingPositionTop:o.position().top,startingOffsetLeft:g,startingOffsetTop:m,parentOffsetLeft:O,parentOffsetTop:L,stellarRatio:o.data("stellar-background-ratio")===s?1:o.data("stellar-background-ratio")})}))},_reset:function(){var t,e,i,s,n;for(n=this.particles.length-1;n>=0;n--)t=this.particles[n],e=t.$element.data("stellar-startingLeft"),i=t.$element.data("stellar-startingTop"),this._setPosition(t.$element,e,e,i,i),this.options.showElement(t.$element),t.$element.data("stellar-startingLeft",null).data("stellar-elementIsActive",null).data("stellar-backgroundIsActive",null);for(n=this.backgrounds.length-1;n>=0;n--)s=this.backgrounds[n],s.$element.data("stellar-backgroundStartingLeft",null).data("stellar-backgroundStartingTop",null),u(s.$element,s.startingValueLeft,s.startingValueTop)},destroy:function(){this._reset(),this.$scrollElement.unbind("resize."+this.name).unbind("scroll."+this.name),this._animationLoop=t.noop,t(e).unbind("load."+this.name).unbind("resize."+this.name)},_setOffsets:function(){var i=this,s=t(e);s.unbind("resize.horizontal-"+this.name).unbind("resize.vertical-"+this.name),"function"==typeof this.options.horizontalOffset?(this.horizontalOffset=this.options.horizontalOffset(),s.bind("resize.horizontal-"+this.name,function(){i.horizontalOffset=i.options.horizontalOffset()})):this.horizontalOffset=this.options.horizontalOffset,"function"==typeof this.options.verticalOffset?(this.verticalOffset=this.options.verticalOffset(),s.bind("resize.vertical-"+this.name,function(){i.verticalOffset=i.options.verticalOffset()})):this.verticalOffset=this.options.verticalOffset},_repositionElements:function(){var n,o,r,a,l,h,p,d,g,m,t=this._getScrollLeft(),e=this._getScrollTop(),f=!0,c=!0;if(this.currentScrollLeft!==t||this.currentScrollTop!==e||this.currentWidth!==this.viewportWidth||this.currentHeight!==this.viewportHeight){for(this.currentScrollLeft=t,this.currentScrollTop=e,this.currentWidth=this.viewportWidth,this.currentHeight=this.viewportHeight,m=this.particles.length-1;m>=0;m--)n=this.particles[m],o=n.isFixed?1:0,this.options.horizontalScrolling?(h=(t+n.horizontalOffset+this.viewportOffsetLeft+n.startingPositionLeft-n.startingOffsetLeft+n.parentOffsetLeft)*-(n.stellarRatio+o-1)+n.startingPositionLeft,d=h-n.startingPositionLeft+n.startingOffsetLeft):(h=n.startingPositionLeft,d=n.startingOffsetLeft),this.options.verticalScrolling?(p=(e+n.verticalOffset+this.viewportOffsetTop+n.startingPositionTop-n.startingOffsetTop+n.parentOffsetTop)*-(n.stellarRatio+o-1)+n.startingPositionTop,g=p-n.startingPositionTop+n.startingOffsetTop):(p=n.startingPositionTop,g=n.startingOffsetTop),this.options.hideDistantElements&&(c=!this.options.horizontalScrolling||d+n.width>(n.isFixed?0:t)&&d<(n.isFixed?0:t)+this.viewportWidth+this.viewportOffsetLeft,f=!this.options.verticalScrolling||g+n.height>(n.isFixed?0:e)&&g<(n.isFixed?0:e)+this.viewportHeight+this.viewportOffsetTop),c&&f?(n.isHidden&&(this.options.showElement(n.$element),n.isHidden=!1),this._setPosition(n.$element,h,n.startingPositionLeft,p,n.startingPositionTop)):n.isHidden||(this.options.hideElement(n.$element),n.isHidden=!0);for(m=this.backgrounds.length-1;m>=0;m--)r=this.backgrounds[m],o=r.isFixed?0:1,a=this.options.horizontalScrolling?(t+r.horizontalOffset-this.viewportOffsetLeft-r.startingOffsetLeft+r.parentOffsetLeft-r.startingBackgroundPositionLeft)*(o-r.stellarRatio)+"px":r.startingValueLeft,l=this.options.verticalScrolling?(e+r.verticalOffset-this.viewportOffsetTop-r.startingOffsetTop+r.parentOffsetTop-r.startingBackgroundPositionTop)*(o-r.stellarRatio)+"px":r.startingValueTop,u(r.$element,a,l)}},_handleScrollEvent:function(){var t=this,e=!1,i=function(){t._repositionElements(),e=!1},s=function(){e||(p(i),e=!0)};this.$scrollElement.bind("scroll."+this.name,s),s()},_startAnimationLoop:function(){var t=this;this._animationLoop=function(){p(t._animationLoop),t._repositionElements()},this._animationLoop()}},t.fn[n]=function(e){var i=arguments;return e===s||"object"==typeof e?this.each(function(){t.data(this,"plugin_"+n)||t.data(this,"plugin_"+n,new d(this,e))}):"string"==typeof e&&"_"!==e[0]&&"init"!==e?this.each(function(){var s=t.data(this,"plugin_"+n);s instanceof d&&"function"==typeof s[e]&&s[e].apply(s,Array.prototype.slice.call(i,1)),"destroy"===e&&t.data(this,"plugin_"+n,null)}):void 0},t[n]=function(){var s=t(e);return s.stellar.apply(s,Array.prototype.slice.call(arguments,0))},t[n].scrollProperty=r,t[n].positionProperty=a,e.Stellar=d}(jQuery,this,document);